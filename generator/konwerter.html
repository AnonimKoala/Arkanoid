<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        let levelList = []
        fetch("basicLevels.json")
            .then(function (response) {
                return response.json();
            })
            .then(function (jsonFile) {
                jsonFile.forEach((el, i) => {
                    levelList.push(el)
                })
            })
            .then(() => {
                levelList.forEach((el, i) => {
                    el.bricks.forEach((brick, i) => {
                        brick.x = (parseInt(brick.x) + 1) / 5 - 0.1
                        brick.y = parseInt(brick.y) / 5
                    })
                })

            })
            .then(() => {
                exportJSON(levelList)
            })

// ==================================================================================================== //
// Export poziomów do pliku JSON
// ==================================================================================================== //
function exportJSON(levelList) {
    let allLevels = levelList
    // for (let i = 0; i < localStorage.length; i++) {
    //     let key = localStorage.key(i)
    //     let level = JSON.parse(localStorage.getItem(key))
    //     let object = {
    //         id: key,
    //         bricks: level
    //     }

    //     allLevels.push(object)
    // }
    let json = JSON.stringify(allLevels)
    console.log(json);
    var textFileAsBlob = new Blob([json], { type: 'text/plain' });
    var fileNameToSaveAs = "levels.json";

    var downloadLink = document.createElement("a");
    downloadLink.download = fileNameToSaveAs;
    downloadLink.innerHTML = "Download File";
    if (window.webkitURL != null) {
        // Chrome pozwala aby link został kliknięty
        // bez dodawania do DOM.
        downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
    }
    else {
        // Firefox wymaga dodania linku do DOM
        // zanim można go kliknąć.
        downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
        downloadLink.onclick = destroyClickedElement;
        downloadLink.style.display = "none";
        document.body.appendChild(downloadLink);
    }

    // downloadLink.click();
}

    </script>
</body>

</html>